<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<link  href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

<!-- <p id="notice"><%#= notice %></p> -->
<div class="min-height">
  <h1>Products</h1>
  <span>
    <%= form_tag products_path, :method => 'get' do %>
      <p>
        <%= text_field_tag :search, params[:search], id: 'search' %>
        <%= submit_tag "Search", :name => nil %>
        <%= button_tag 'CLEAR', id: 'clear_form_button' %>
      </p>
    <% end %>
    <%= javascript_pack_tag 'clear' %>
  </span>

  <% if current_user.try(:type) == 'AdminUser' %>
    <div class="new_product">
      <%= link_to 'New Product', new_product_path %>
    </div>
  <% end %>
  <table class='table table-striped table-responsive-md btn-table'>
    <%= form_with url: print_labels_products_url, local: true, method: :post do |form| %>
    <thead>
      <tr class="sort-table">
        <th>ID</th>
        <% if current_user.try(:type) == 'AdminUser' %>
          <th>
            <input type="checkbox" id="selectAll" value="selectAll">
            <%= form.submit "Labels", data: { disable_with: false } %>
          </th>
        <% end %>
        <th><%= sortable "item_no", "Item #" %></th>
        <th><%= sortable "description" %></th>
        <th><%= sortable "supplier_number", "Supplier #" %></th>
        <th><%= sortable "qty" %></th>
        <th><%= sortable "location" %></th>
        <th><%= sortable "supplier_name" %></th>
        <th><%= sortable "status" %></th>
        <!-- <th>QR-Code</th> -->
        <th colspan="2"></th>

      </tr>
    </thead>
  <!---------------- check all checkboxes --------------->
    <script type='text/javascript'>
      $('#selectAll').click(function() {
         if (this.checked) {
             $(':checkbox').each(function() {
                 this.checked = true;                        
             });
         } else {
            $(':checkbox').each(function() {
                 this.checked = false;                        
             });
         } 
      });
    </script>
  <!---------------- check all checkboxes --------------->

    <tbody>
      
      <% @products.each do |product| %>
        <% if product.status == "active" %>
          <tr>
            <td><%= product.id %></td>
            <% if current_user.try(:type) == 'AdminUser' %>
              <td><%= form.check_box :products_ids, {multiple: true}, product.id %></td>
            <% end %>
            <td><%=  link_to truncate(product.item_no.truncate(22)).html_safe, product %></td>
            <td><%= link_to truncate(product.description.truncate(22)).capitalize.html_safe, product %></td>
            <td><%= product.supplier_number %></td>
            <td><%= product.qty %></td>
            <td><%= product.location %></td>
            <td><%= product.supplier_name %></td>
            <!-- <td><%#= QrCode.call(product_url(product))%></td> -->
            <% if current_user.try(:type) != 'AdminUser' %>
              <td><%= link_to 'Use', use_product_path(product), class: "btn btn-primary" %></td>
            <% end %>
            <!-- <td>
              <%#= link_to 'Show', product %>
            </td> -->
            <% if current_user.try(:type) == 'AdminUser' %>

              <td>
                <%= link_to edit_product_path(product) do%>
                  <i class="fa fa-edit" width="50px" height="50px"></i>  
                <% end %>
              </td>
              <td>
                <%= link_to "Delete", product, method: :delete, data: { confirm: 'Are you sure you want to delete record?' }, class: "btn btn-danger btn-sm"%>
              </td>
            <% end %>
          </tr>
        
       <% else %>
        
          <tr style="background-color: #ffa791;">
            <td><%= product.id %></td>
            
              <td></td>
            
            <td><%=  link_to truncate(product.item_no.truncate(22)).html_safe, product %></td>
            <td><%= link_to truncate(product.description.truncate(22)).capitalize.html_safe, product %></td>
            <td><%= product.supplier_number %></td>
            <td><%= product.qty %></td>
            <td><%= product.location %></td>
            <td><%= product.supplier_name %></td>
            <!-- <td><%#= QrCode.call(product_url(product))%></td> -->
            <% if current_user.try(:type) != 'AdminUser' %>
              <td><%= link_to 'Use', use_product_path(product), class: "btn btn-primary" %></td>
            <% end %>
            <!-- <td>
              <%#= link_to 'Show', product %>
            </td> -->
            <% if current_user.try(:type) == 'AdminUser' %>

              <td>
                <%= link_to edit_product_path(product) do%>
                  <i class="fa fa-edit" width="50px" height="50px"></i>  
                <% end %>
              </td>
              <td>
                <%= link_to "Delete", product, method: :delete, data: { confirm: 'Are you sure you want to delete record?' }, class: "btn btn-danger btn-sm"%>
              </td>
            <% end %>
          </tr>
        <% end %>
      <% end %>
        <!-- <tr>
          <td>
            <%#= form.submit "Print labels", data: { disable_with: false } %>
          </td>
        </tr> -->
      <% end %>
    </tbody>
  </table>

</div>





